{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-01T15:27:02.863223Z", "invocation_id": "67a1b0ba-84ed-4485-a769-e9021dfe22c9", "invocation_started_at": "2025-11-01T15:27:01.830269Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-01T15:27:02.735413Z", "completed_at": "2025-11-01T15:27:02.740432Z"}, {"name": "execute", "started_at": "2025-11-01T15:27:02.740666Z", "completed_at": "2025-11-01T15:27:02.824990Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09000897407531738, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.quarterly_fundamentals_wide", "compiled": true, "compiled_code": "\n\nWITH base AS (\n  SELECT\n    ticker      AS ticker,\n    fiscal_date AS fiscal_date,\n    argMax(currency, loaded_at) AS currency\n  FROM `fundamentals`.`quarterly_fundamentals_long`\n  GROUP BY ticker, fiscal_date\n),\ninc AS (\n  SELECT\n    ticker, fiscal_date,\n    maxIf(value, metric = 'Total Revenue')    AS total_revenue,\n    maxIf(value, metric = 'Cost Of Revenue')  AS cost_of_revenue,\n    maxIf(value, metric = 'Gross Profit')     AS gross_profit,\n    maxIf(value, metric = 'Operating Income') AS operating_income,\n    maxIf(value, metric = 'Net Income')       AS net_income\n  FROM `fundamentals`.`quarterly_fundamentals_long`\n  WHERE statement = 'income_statement'\n  GROUP BY ticker, fiscal_date\n),\nbs AS (\n  SELECT\n    ticker, fiscal_date,\n    maxIf(value, metric = 'Total Assets')                  AS total_assets,\n    maxIf(value, metric = 'Total Liab')                    AS total_liab,\n    maxIf(value, metric = 'Total Stockholder Equity')      AS equity,\n    maxIf(value, metric = 'Total Current Assets')          AS current_assets,\n    maxIf(value, metric = 'Total Current Liabilities')     AS current_liab,\n    maxIf(value, metric = 'Cash And Cash Equivalents')     AS cash_and_equiv,\n    maxIf(value, metric = 'Long Term Debt')                AS long_term_debt\n  FROM `fundamentals`.`quarterly_fundamentals_long`\n  WHERE statement = 'balance_sheet'\n  GROUP BY ticker, fiscal_date\n),\ncf AS (\n  SELECT\n    ticker, fiscal_date,\n    maxIf(value, metric = 'Total Cash From Operating Activities') AS cfo,\n    maxIf(value, metric = 'Capital Expenditures')                 AS capex\n  FROM `fundamentals`.`quarterly_fundamentals_long`\n  WHERE statement = 'cashflow_statement'\n  GROUP BY ticker, fiscal_date\n)\n\nSELECT\n  b.ticker       AS ticker,\n  b.fiscal_date  AS fiscal_date,\n  b.currency     AS currency,\n  inc.total_revenue,\n  inc.cost_of_revenue,\n  inc.gross_profit,\n  inc.operating_income,\n  inc.net_income,\n  bs.total_assets,\n  bs.total_liab,\n  bs.equity,\n  bs.current_assets,\n  bs.current_liab,\n  bs.cash_and_equiv,\n  bs.long_term_debt,\n  cf.cfo,\n  cf.capex\nFROM base b\nLEFT JOIN inc ON b.ticker = inc.ticker AND b.fiscal_date = inc.fiscal_date\nLEFT JOIN bs  ON b.ticker = bs.ticker  AND b.fiscal_date = bs.fiscal_date\nLEFT JOIN cf  ON b.ticker = cf.ticker  AND b.fiscal_date = cf.fiscal_date", "relation_name": "`fundamentals`.`quarterly_fundamentals_wide`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-01T15:27:02.827561Z", "completed_at": "2025-11-01T15:27:02.829708Z"}, {"name": "execute", "started_at": "2025-11-01T15:27:02.829909Z", "completed_at": "2025-11-01T15:27:02.845056Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017972230911254883, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.key_ratios_quarterly_long", "compiled": true, "compiled_code": "\n\nWITH w AS (\n  SELECT * FROM `fundamentals`.`quarterly_fundamentals_wide`\n),\nr AS (\n  SELECT\n    w.ticker, w.fiscal_date, w.currency,\n    ifNull(w.gross_profit     / nullIf(w.total_revenue, 0), 0) AS gross_margin,\n    ifNull(w.operating_income / nullIf(w.total_revenue, 0), 0) AS operating_margin,\n    ifNull(w.net_income       / nullIf(w.total_revenue, 0), 0) AS net_margin,\n    ifNull(w.current_assets   / nullIf(w.current_liab, 0), 0)  AS current_ratio,\n    ifNull(w.total_liab       / nullIf(w.equity, 0), 0)        AS debt_to_equity,\n    (w.cfo - w.capex)                                          AS fcf\n  FROM w\n)\nSELECT ticker, fiscal_date, currency, 'gross_margin'     AS metric, toFloat64(gross_margin)     AS value FROM r\nUNION ALL\nSELECT ticker, fiscal_date, currency, 'operating_margin',          toFloat64(operating_margin)          FROM r\nUNION ALL\nSELECT ticker, fiscal_date, currency, 'net_margin',                toFloat64(net_margin)                FROM r\nUNION ALL\nSELECT ticker, fiscal_date, currency, 'current_ratio',             toFloat64(current_ratio)             FROM r\nUNION ALL\nSELECT ticker, fiscal_date, currency, 'debt_to_equity',            toFloat64(debt_to_equity)            FROM r\nUNION ALL\nSELECT ticker, fiscal_date, currency, 'fcf',                       toFloat64(fcf)                       FROM r", "relation_name": "`fundamentals`.`key_ratios_quarterly_long`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-01T15:27:02.846832Z", "completed_at": "2025-11-01T15:27:02.849030Z"}, {"name": "execute", "started_at": "2025-11-01T15:27:02.849236Z", "completed_at": "2025-11-01T15:27:02.860791Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0143890380859375, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.key_ratios_quarterly_wide", "compiled": true, "compiled_code": "\n\nSELECT\n  w.ticker,\n  w.fiscal_date,\n  w.currency,\n  w.total_revenue,\n  w.gross_profit,\n  w.operating_income,\n  w.net_income,\n  w.total_assets,\n  w.total_liab,\n  w.equity,\n  w.current_assets,\n  w.current_liab,\n  w.cash_and_equiv,\n  w.long_term_debt,\n  w.cfo,\n  w.capex,\n  ifNull(w.gross_profit     / nullIf(w.total_revenue, 0), 0) AS gross_margin,\n  ifNull(w.operating_income / nullIf(w.total_revenue, 0), 0) AS operating_margin,\n  ifNull(w.net_income       / nullIf(w.total_revenue, 0), 0) AS net_margin,\n  ifNull(w.current_assets   / nullIf(w.current_liab, 0), 0)  AS current_ratio,\n  ifNull(w.total_liab       / nullIf(w.equity, 0), 0)        AS debt_to_equity,\n  (w.cfo - w.capex)                                          AS fcf\nFROM `fundamentals`.`quarterly_fundamentals_wide` AS w", "relation_name": "`fundamentals`.`key_ratios_quarterly_wide`", "batch_results": null}], "elapsed_time": 0.46651697158813477, "args": {"vars": {}, "printer_width": 80, "log_format_file": "debug", "require_nested_cumulative_type_params": false, "show_all_deprecations": false, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors": true, "skip_nodes_if_on_run_start_fails": false, "cache_selected_only": false, "write_json": true, "print": true, "log_path": "/Users/deucalion/Developer/Python/Ademola/Family Office/qi/src/qi/dbt_project/logs", "state_modified_compare_vars": false, "require_generic_test_arguments_property": true, "defer": false, "partial_parse_file_diff": true, "partial_parse": true, "macro_debugging": false, "require_all_warnings_handled_by_warn_error": false, "which": "run", "require_resource_names_without_spaces": true, "send_anonymous_usage_stats": true, "strict_mode": false, "select": ["fundamentals.quarterly_fundamentals_wide", "fundamentals.key_ratios_quarterly_wide", "fundamentals.key_ratios_quarterly_long"], "log_level_file": "debug", "warn_error_options": {"error": [], "warn": [], "silence": []}, "exclude": [], "use_fast_test_edges": false, "upload_to_artifacts_ingest_api": false, "log_level": "info", "indirect_selection": "eager", "profiles_dir": "/Users/deucalion/Developer/Python/Ademola/Family Office/qi/src/qi/dbt_project", "source_freshness_run_project_hooks": true, "static_parser": true, "introspect": true, "quiet": false, "state_modified_compare_more_unrendered_values": false, "validate_macro_args": false, "version_check": true, "favor_state": false, "log_file_max_bytes": 10485760, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true, "empty": false, "populate_cache": true, "log_format": "default", "project_dir": "/Users/deucalion/Developer/Python/Ademola/Family Office/qi/src/qi/dbt_project", "show_resource_report": false, "require_yaml_configuration_for_mf_time_spines": false, "invocation_command": "dbt run --select fundamentals.quarterly_fundamentals_wide fundamentals.key_ratios_quarterly_wide fundamentals.key_ratios_quarterly_long"}}