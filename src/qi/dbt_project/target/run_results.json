{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-03T19:08:39.599565Z", "invocation_id": "57f09c34-4196-4aac-9f37-9a846caded17", "invocation_started_at": "2025-11-03T19:08:37.814772Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.360874Z", "completed_at": "2025-11-03T19:08:39.365771Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.366067Z", "completed_at": "2025-11-03T19:08:39.398117Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038056135177612305, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.00_v_52w_performance", "compiled": true, "compiled_code": "\n\nWITH addYears(today(), -1) AS cutoff\nSELECT\n    ticker,\n    argMax(short_name, date) AS name,\n    max(date)                AS last_date,\n    argMax(close, date)      AS last_close,\n    maxIf(close, date >= cutoff) AS high_52w,\n    minIf(close, date >= cutoff) AS low_52w,\n    round(100 * (argMax(close, date) - minIf(close, date >= cutoff))\n          / nullIf(minIf(close, date >= cutoff), 0), 2) AS pct_from_low,\n    round(100 * (argMax(close, date) - maxIf(close, date >= cutoff))\n          / nullIf(maxIf(close, date >= cutoff), 0), 2) AS pct_from_high\nFROM market.daily_prices\nWHERE date >= cutoff\nGROUP BY ticker\nORDER BY pct_from_low DESC\nLIMIT 20", "relation_name": "`analytics`.`00_v_52w_performance`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.401316Z", "completed_at": "2025-11-03T19:08:39.451072Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.451398Z", "completed_at": "2025-11-03T19:08:39.461201Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06059122085571289, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.01_v_top_1d_movers", "compiled": true, "compiled_code": "\n\nWITH\n  d AS (SELECT max(date) AS d FROM market.daily_prices),\n  prev_d AS (\n    SELECT max(date) AS d\n    FROM market.daily_prices\n    WHERE date < (SELECT d FROM d)\n  )\nSELECT\n  ticker,\n  argMax(short_name, date)                                           AS name,\n  (SELECT d FROM d)                                                  AS last_date,\n  argMaxIf(close, date, date = (SELECT d FROM d))                    AS close_last,\n  argMaxIf(close, date, date = (SELECT d FROM prev_d))               AS close_prev,\n  round(100 * (close_last - nullIf(close_prev, 0)) / nullIf(close_prev, 0), 2) AS pct_change\nFROM market.daily_prices\nWHERE date IN ((SELECT d FROM d), (SELECT d FROM prev_d))\nGROUP BY ticker\nHAVING close_last IS NOT NULL AND close_prev IS NOT NULL\nORDER BY pct_change DESC\nLIMIT 50", "relation_name": "`analytics`.`01_v_top_1d_movers`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.464467Z", "completed_at": "2025-11-03T19:08:39.466881Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.467147Z", "completed_at": "2025-11-03T19:08:39.476222Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012649774551391602, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.02_v_volume_surge", "compiled": true, "compiled_code": "\n\nWITH d AS (SELECT max(date) AS d FROM market.daily_prices)\nSELECT\n  ticker,\n  argMax(short_name, date)                                             AS name,\n  (SELECT d FROM d)                                                    AS last_date,\n  argMaxIf(volume, date, date = (SELECT d FROM d))                     AS volume_today,\n  avgIf(volume, date >= (SELECT d FROM d) - toIntervalDay(20)\n                 AND date <= (SELECT d FROM d))                        AS vol_20d_avg,\n  round(volume_today / nullIf(vol_20d_avg, 0), 2)                      AS vol_surge\nFROM market.daily_prices\nWHERE date >= (SELECT d FROM d) - toIntervalDay(20)\nGROUP BY ticker\nHAVING volume_today IS NOT NULL AND vol_20d_avg > 0\nORDER BY vol_surge DESC\nLIMIT 50", "relation_name": "`analytics`.`02_v_volume_surge`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.479197Z", "completed_at": "2025-11-03T19:08:39.481549Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.481934Z", "completed_at": "2025-11-03T19:08:39.490153Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011823415756225586, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.03_v_gap_scan", "compiled": true, "compiled_code": "\n\nWITH latest AS (SELECT max(date) d FROM market.daily_prices)\nSELECT\n  t.ticker,\n  argMax(t.short_name, t.date) AS name,\n  anyLast(t.date)              AS date,\n  anyLast(t.open)              AS open_today,\n  anyLast(prev_close)          AS prev_close,\n  (open_today - prev_close) / nullIf(prev_close, 0) * 100 AS gap_pct\nFROM\n(\n  SELECT\n    ticker, date, short_name, open,\n    lagInFrame(close, 1) OVER (PARTITION BY ticker ORDER BY date) AS prev_close\n  FROM market.daily_prices\n) AS t\nGROUP BY t.ticker\nHAVING anyLast(t.date) = (SELECT d FROM latest)\nORDER BY gap_pct DESC\nLIMIT 50", "relation_name": "`analytics`.`03_v_gap_scan`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.493039Z", "completed_at": "2025-11-03T19:08:39.495715Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.496033Z", "completed_at": "2025-11-03T19:08:39.504395Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012102365493774414, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.04_v_momentum_20d_60d", "compiled": true, "compiled_code": "\n\nWITH latest AS (SELECT max(date) d FROM market.daily_prices)\nSELECT\n  ticker,\n  argMax(short_name, date) AS name,\n  anyLast(close)           AS last_close,\n  (anyLast(close) - anyLast(close_20d)) / nullIf(anyLast(close_20d), 0) * 100 AS ret_20d_pct,\n  (anyLast(close) - anyLast(close_60d)) / nullIf(anyLast(close_60d), 0) * 100 AS ret_60d_pct\nFROM\n(\n  SELECT\n    ticker, date, short_name, close,\n    lagInFrame(close, 20) OVER (PARTITION BY ticker ORDER BY date) AS close_20d,\n    lagInFrame(close, 60) OVER (PARTITION BY ticker ORDER BY date) AS close_60d\n  FROM market.daily_prices\n) t\nGROUP BY ticker\nHAVING max(date) = (SELECT d FROM latest)\nORDER BY ret_20d_pct DESC\nLIMIT 100", "relation_name": "`analytics`.`04_v_momentum_20d_60d`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.508347Z", "completed_at": "2025-11-03T19:08:39.510570Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.510841Z", "completed_at": "2025-11-03T19:08:39.517924Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010263681411743164, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.05_v_distance_from_sma", "compiled": true, "compiled_code": "\n\nWITH latest AS (SELECT max(date) d FROM market.daily_prices)\nSELECT\n  ticker,\n  argMax(short_name, date) AS name,\n  anyLast(close) AS last_close,\n  anyLast(sma50) AS sma50,\n  anyLast(sma200) AS sma200,\n  (last_close - sma50) / nullIf(sma50, 0) * 100 AS dist_sma50_pct,\n  (last_close - sma200)/ nullIf(sma200,0) * 100 AS dist_sma200_pct\nFROM\n(\n  SELECT\n    ticker,\n    date,\n    short_name,\n    close,\n    avg(close) OVER (PARTITION BY ticker ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)  AS sma50,\n    avg(close) OVER (PARTITION BY ticker ORDER BY date ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200\n  FROM market.daily_prices\n) s\nGROUP BY ticker\nHAVING max(date) = (SELECT d FROM latest)\nORDER BY dist_sma50_pct DESC\nLIMIT 100", "relation_name": "`analytics`.`05_v_distance_from_sma`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.521075Z", "completed_at": "2025-11-03T19:08:39.523681Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.524004Z", "completed_at": "2025-11-03T19:08:39.531923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011552810668945312, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.06_v_breadth_pct_above_sma", "compiled": true, "compiled_code": "\n\nWITH d AS (SELECT max(date) AS d FROM market.daily_prices)\nSELECT\n  countIf(last_close > sma50)  / toFloat64(count()) * 100 AS pct_above_50d,\n  countIf(last_close > sma200) / toFloat64(count()) * 100 AS pct_above_200d\nFROM\n(\n  SELECT\n    ticker,\n    date,\n    close AS last_close,\n    avg(close) OVER (PARTITION BY ticker ORDER BY date\n                     ROWS BETWEEN 49 PRECEDING AND CURRENT ROW)  AS sma50,\n    avg(close) OVER (PARTITION BY ticker ORDER BY date\n                     ROWS BETWEEN 199 PRECEDING AND CURRENT ROW) AS sma200,\n    row_number() OVER (PARTITION BY ticker ORDER BY date DESC)    AS rn\n  FROM market.daily_prices\n  WHERE date <= (SELECT d FROM d)\n)\nWHERE rn = 1", "relation_name": "`analytics`.`06_v_breadth_pct_above_sma`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.534657Z", "completed_at": "2025-11-03T19:08:39.537254Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.537672Z", "completed_at": "2025-11-03T19:08:39.546523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012539863586425781, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.07_v_52w_scanner", "compiled": true, "compiled_code": "\n\nWITH\n  (SELECT max(date) FROM market.daily_prices) AS latest,\n  addYears(latest, -1) AS cutoff\nSELECT\n  ticker,\n  argMax(short_name, date)               AS name,\n  maxIf(close, date >= cutoff)           AS high_52w,\n  minIf(close, date >= cutoff)           AS low_52w,\n  argMax(close, date)                    AS last_close,\n  round(100 * (last_close - low_52w)  / nullIf(low_52w,  0), 2) AS pct_from_low,\n  round(100 * (last_close - high_52w) / nullIf(high_52w, 0), 2) AS pct_from_high\nFROM market.daily_prices\nWHERE date >= cutoff\nGROUP BY ticker\nORDER BY pct_from_low DESC\nLIMIT 100", "relation_name": "`analytics`.`07_v_52w_scanner`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.549331Z", "completed_at": "2025-11-03T19:08:39.552138Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.552509Z", "completed_at": "2025-11-03T19:08:39.562427Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013813257217407227, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.08_v_atr14_pct", "compiled": true, "compiled_code": "\n\nWITH\n  (SELECT max(date) FROM market.daily_prices) AS latest\nSELECT\n  t.ticker,\n  t.name,\n  t.last_date AS date,\n  t.last_close,\n  t.last_atr14,\n  round(t.last_atr14 / nullIf(t.last_close, 0) * 100, 2) AS atr14_pct\nFROM\n(\n  SELECT\n    ticker,\n    argMax(short_name, date) AS name,\n    max(date)                AS last_date,\n    argMax(close,  date)     AS last_close,\n    argMax(atr14,  date)     AS last_atr14\n  FROM\n  (\n    SELECT\n      ticker,\n      date,\n      short_name,\n      close,\n      avg(tr) OVER (\n        PARTITION BY ticker\n        ORDER BY date\n        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW\n      ) AS atr14\n    FROM\n    (\n      SELECT\n        ticker,\n        date,\n        short_name,\n        close,\n        high,\n        low,\n        abs(high - low) AS hl,\n        abs(high - lagInFrame(close, 1) OVER (PARTITION BY ticker ORDER BY date)) AS hc,\n        abs(low  - lagInFrame(close, 1) OVER (PARTITION BY ticker ORDER BY date)) AS lc,\n        greatest(hl, greatest(hc, lc)) AS tr\n      FROM market.daily_prices\n    )\n  )\n  GROUP BY ticker\n) AS t\nWHERE t.last_date = latest\nORDER BY atr14_pct DESC\nLIMIT 100", "relation_name": "`analytics`.`08_v_atr14_pct`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.565704Z", "completed_at": "2025-11-03T19:08:39.569586Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.569932Z", "completed_at": "2025-11-03T19:08:39.579493Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014473199844360352, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.09_v_inside_outside_day", "compiled": true, "compiled_code": "\n\nWITH\n  (SELECT max(date) FROM market.daily_prices) AS latest\nSELECT\n  t.ticker,\n  t.name,\n  t.last_date AS date,\n  t.open_today,\n  t.high_today,\n  t.low_today,\n  t.close_today,\n  case\n    when t.high_today > t.prev_high AND t.low_today < t.prev_low then 'outside'\n    when t.high_today < t.prev_high AND t.low_today > t.prev_low then 'inside'\n    else 'normal'\n  end AS day_type\nFROM\n(\n  SELECT\n    ticker,\n    argMax(short_name, date) AS name,\n    max(date)                AS last_date,\n    argMax(open, date)       AS open_today,\n    argMax(high, date)       AS high_today,\n    argMax(low, date)        AS low_today,\n    argMax(close, date)      AS close_today,\n    argMax(prev_high, date)  AS prev_high,\n    argMax(prev_low, date)   AS prev_low\n  FROM\n  (\n    SELECT\n      ticker,\n      date,\n      short_name,\n      open,\n      high,\n      low,\n      close,\n      lagInFrame(high, 1) OVER (PARTITION BY ticker ORDER BY date) AS prev_high,\n      lagInFrame(low, 1)  OVER (PARTITION BY ticker ORDER BY date) AS prev_low\n    FROM market.daily_prices\n  )\n  GROUP BY ticker\n) AS t\nWHERE t.last_date = latest\nORDER BY\n  case\n    when day_type = 'outside' then 1\n    when day_type = 'inside'  then 2\n    else 3\n  end,\n  t.ticker\nLIMIT 200", "relation_name": "`analytics`.`09_v_inside_outside_day`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-03T19:08:39.582672Z", "completed_at": "2025-11-03T19:08:39.585195Z"}, {"name": "execute", "started_at": "2025-11-03T19:08:39.585465Z", "completed_at": "2025-11-03T19:08:39.594653Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012683391571044922, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.qi_dbt_project.10_v_rv30_and_rank", "compiled": true, "compiled_code": "\n\nWITH\n  (SELECT max(date) FROM market.daily_prices) AS latest,\n  addYears(latest, -1) AS cutoff_1y\nSELECT\n  s.ticker,\n  argMax(s.short_name, s.date) AS name,\n  argMax(s.rv30, s.date)       AS rv30,         -- current rv30\n  round(\n    100 * sumIf(s.rv30 <= cur.curr_rv30, s.date >= cutoff_1y)\n        / nullIf(countIf(s.date >= cutoff_1y), 0),\n    2\n  )                            AS rv30_rank_1y\nFROM\n(\n  SELECT\n    b.ticker,\n    b.date,\n    b.short_name,\n    stddevPop(b.ret)\n      OVER (PARTITION BY b.ticker ORDER BY b.date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW)\n      * sqrt(252)              AS rv30\n  FROM\n  (\n    SELECT\n      ticker,\n      date,\n      short_name,\n      (log(close) - log(lagInFrame(close, 1) OVER (PARTITION BY ticker ORDER BY date))) AS ret\n    FROM market.daily_prices\n  ) AS b\n) AS s\nINNER JOIN\n(\n  SELECT\n    v.ticker,\n    max(v.date)            AS last_date,\n    argMax(v.rv30, v.date) AS curr_rv30\n  FROM\n  (\n    SELECT\n      b.ticker,\n      b.date,\n      stddevPop(b.ret)\n        OVER (PARTITION BY b.ticker ORDER BY b.date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW)\n        * sqrt(252)        AS rv30\n    FROM\n    (\n      SELECT\n        ticker,\n        date,\n        (log(close) - log(lagInFrame(close, 1) OVER (PARTITION BY ticker ORDER BY date))) AS ret\n      FROM market.daily_prices\n    ) AS b\n  ) AS v\n  GROUP BY v.ticker\n) AS cur USING (ticker)\nWHERE s.date >= cutoff_1y\nGROUP BY s.ticker\nHAVING max(s.date) = latest\nORDER BY rv30_rank_1y DESC\nLIMIT 100", "relation_name": "`analytics`.`10_v_rv30_and_rank`", "batch_results": null}], "elapsed_time": 0.5085947513580322, "args": {"log_file_max_bytes": 10485760, "partial_parse": true, "indirect_selection": "eager", "partial_parse_file_diff": true, "validate_macro_args": false, "profiles_dir": "/opt/airflow/dags/src/qi/dbt_project", "strict_mode": false, "cache_selected_only": false, "upload_to_artifacts_ingest_api": false, "invocation_command": "dbt run --select analytics", "print": true, "quiet": false, "log_format_file": "debug", "use_colors_file": true, "source_freshness_run_project_hooks": true, "use_fast_test_edges": false, "log_level": "info", "use_colors": true, "log_format": "default", "target": "dev", "write_json": true, "favor_state": false, "require_resource_names_without_spaces": true, "require_yaml_configuration_for_mf_time_spines": false, "log_path": "/opt/airflow/dags/src/qi/dbt_project/logs", "require_batched_execution_for_custom_microbatch_strategy": false, "require_all_warnings_handled_by_warn_error": false, "show_all_deprecations": false, "static_parser": true, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "populate_cache": true, "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "which": "run", "require_generic_test_arguments_property": true, "empty": false, "select": ["analytics"], "send_anonymous_usage_stats": true, "show_resource_report": false, "defer": false, "vars": {}, "version_check": true, "project_dir": "/opt/airflow/dags/src/qi/dbt_project", "require_explicit_package_overrides_for_builtin_materializations": true, "macro_debugging": false, "log_level_file": "debug", "exclude": [], "introspect": true, "printer_width": 80}}